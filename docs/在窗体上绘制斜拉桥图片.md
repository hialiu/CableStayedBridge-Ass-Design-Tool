# 使用 `DrawPic.py` 脚本绘制斜拉桥立面示意图

## `py` 文件说明
py 文件默认保存图片为 png 格式，也可以导出为可编辑的矢量格式例如 svg 或 eps，这些矢量图可以与 dwg 无损转换，只需在 py 文件中更改如下代码
```python
plt.savefig("temp.svg", dpi=300, format='svg')
```

但是 `c#` 中 `pictureBox` 无法显示矢量图，所以若后期需考虑导出 dwg，可以采用同时保存 svg 与 png 的方法，分别用于展示和导出。

## 在 `cmd` 中调用
使用形如以下的命令调用，参数之间使用空格隔开

```cmd
python DrawPic.py l1+l2+l3+... h1+h2 d1 d2 loc
```

其中：
- `l1,l2...` 跨径，用 `+` 号连接
- `h1` 下塔柱高度
- `h2` 上塔柱高度
- `d1` 梁上索距
- `d2` 塔上索距
- `loc` 可选参数，表示第一根拉索在塔上位置占上塔柱比例，省略则默认 2/3

## 在 `c#` 中调用
在 `c#` 中创建终端进程，将参数传入终端命令行即可

使用如下代码进行调用：

```c#
string Line = "python DrawPic.py";
Process p = new Process();
p.StartInfo.FileName = "cmd.exe";
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardInput = true;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.RedirectStandardError = true;
p.StartInfo.CreateNoWindow = true;

p.Start();
p.StandardInput.WriteLine($"{Line} {textBoxL.Text}  {textBoxH.Text} {textBoxDOnBeam.Text} {textBoxDOnTown.Text}");
p.StandardInput.WriteLine("exit");
p.StandardInput.AutoFlush = true;
string strOuput = p.StandardOutput.ReadToEnd();
p.WaitForExit();
p.Close();

pictureBox1.ImageLocation = "temp.png";
```
